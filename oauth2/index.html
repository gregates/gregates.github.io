<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">

<title>OAuth 2.0</title>

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<link rel="stylesheet" href="css/reveal.min.css">
<link rel="stylesheet" href="css/theme/simple.css" id="theme">

<!-- For syntax highlighting -->
<link rel="stylesheet" href="lib/css/railscasts.css">

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
if( window.location.search.match( /print-pdf/gi ) ) {
  var link = document.createElement( 'link' );
  link.rel = 'stylesheet';
  link.type = 'text/css';
  link.href = 'css/print/pdf.css';
  document.getElementsByTagName( 'head' )[0].appendChild( link );
}
</script>

<!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">

  <!-- Any section element inside of this container is displayed as a slide -->
  <div class="slides">
    <section>
      <h2>OAuth 2.0</h2>
      <h3>Authorization Framework</h3>
      <a href="http://tools.ietf.org/html/rfc6749">tools.ietf.org/html/rfc6749</a>
    </section>

    <section>
      <ul>
      <li>OAuth 2.0 is a protocol for allowing a <em>Client</em> to access a protected <em>Resource</em> from an HTTP <em>Resource Server</em>.</li>
      <li class="fragment">May require the authorization of a <em>Resource Owner</em>.</li>
      <li class="fragment">There may be an <em>Authorization Server</em> that is distinct from the Resource Server.</li>
      <li class="fragment">Client authorization is via a temporary, revokable <em>Access Token</em> issued by the Authorization Server.</li>
      </ul>
    </section>

    <section>
      <h2>"Traditional" Authorization</h2>
      <ul>
        <li class="fragment">User must authenticate in order to access protected Resources.</li>
        <li class="fragment">Client would need to act <strong>as</strong> the User to access Resources</li>
        <li class="fragment">Client therefore has access to <strong>everything</strong> User does</li>
        <li class="fragment">If Client can authenticate as User, then to revoke Client's access, User must change authentication credentials.</li>
        <li class="fragment">Side Effect: <strong>any</strong> party using old credentials loses access.</li>
      </ul>
    </section>

    <section>
      <h2>Client</h2>
      <p>Examples from our stack:
        <ul>
          <li>Wordpress Install</li>
          <li>Iago</li>
          <li>Drudge</li>
          <li>Grayskull</li>
        </ul>
      </p>
    </section>

    <section>
      <h2>Resource Server</h2>
      <p>Examples from our stack:
        <ul>
          <li>Webkite Auth</li>
          <li>Grayskull</li>
        <ul>
      </p>
    </section>

    <section>
      <h2>Protected Resources</h2>
      <p>Examples from our stack:
        <ul>
          <li>Webkite Identities</li>
          <li>Use Cases</li>
        <ul>
      </p>
    </section>

    <section>
      <section>
        <h2>Server-Side OAuth Flows</h2>
        <img src="server-flow.png" width="800" />
      </section>
      <section>
        <ul>
          <li>Client Authentication via Id &amp; Secret Key</li>
          <li>Access Tokens are unique, temporary, revokable</li>
          <li>Access Token validation required but unspecified</li>
          <li>
            Tokens are typically presented via an HTTP header:<br/>
            <code>Authorization: Bearer &lt;token&gt;</code>
          </li>
          <li>Tokens <strong>must never</strong> be transmitted unencrypted</li>
        </ul>
      </section>
    </section>

    <section>
      <section>
      <h2>Client Credentials Grant</h2>
      <ul>
        <li>Simplest OAuth Flow</li>
        <li>Client authenticates using its own credentials</li>
        <li>Client authorization determined by domain logic</li>
        <li>Specify by sending<br/><code>grant_type=client_credentials</code><br/> to token endpoint
      </ul>
      </section>
      <section>
        <h4>Example Client Credentials Token Request</h4>
        <pre><code>$ curl -X POST http://localhost:9000/oauth/token 
       -d "grant_type=client_credentials
          &client_id=7d0305432ae59d73860e956981fbdd081479a0b0673a43cc1d1cfb3d868eefda
          &client_secret=e2dbe408ad32a5ac9d728052df20996fb6ba8d300a3607c8f408838aca41cc85"

{
  "access_token":"17f513b3c787a8793021d88ec45f9f7554cb61d8a1e79a453c7cf3c2090d37c1",
  "token_type":"bearer",
  "expires_in":7200,
  "scope":"public"
}</code></pre>
      </section>
    </section>

    <section>
      <section>
      <h2>Authorization Code Grant</h2>
      <ul>
        <li>Most common OAuth flow</li>
        <li>Requires presence of User</li>
        <li>User must be authenticated by Authorization Server</li>
        <li>User must grant authorization to the Client<br/> (explicitly or implicitly)</li>
        <li>Client authorization determined by scope of access grant</li>
        <li>Access grant typically does not expire but is revokable</li>
        <li>Specify by sending <code>response_type=code</code><br/> to authorization endpoint</li>
      </ul>
      </section>
      <section>
        <img src="auth-grant.png" />
        <p>Note: Redirect URI sent to token endpoint <strong>must</strong> match Redirect URI from the Authorization Grant request. Redirect URI must also be registered with the Authorization Server for the Client.</p>
      </section>
      <section>
        <h4>Example Authorization Code Request</h4>
        <pre><code>curl -I http://dev.webkite.us:9000/oauth/authorize?
   client_id=f0f59eaa6bb65f753086329e250afe6e6187c2090d0ee5c3964d686a94a02d54
  &redirect_uri=http%3A%2F%2Fdev.webkite.us%3A3000%2Fauth%2Fwebkite%2Fcallback
  &response_type=code
  &state=440f9239d76fbfb312924cab25e34f3e5305784c00f0643e

HTTP/1.1 302 Found
Status: 302 Found
Location: http://dev.webkite.us:3000/auth/webkite/callback?
   code=49a85f5ba0412c4b721e0acd720d723c9736e57ef73887418758d84dc15c068b
  &state=440f9239d76fbfb312924cab25e34f3e5305784c00f0643e</code></pre>
        <h4>Example Authorization Grant Token Request</h4>
        <pre><code>curl -X POST http://dev.webkite.us:9000/oauth/token
     -d "grant_type=authorization_code
        &code=49a85f5ba0412c4b721e0acd720d723c9736e57ef73887418758d84dc15c068b
        &client_id=f0f59eaa6bb65f753086329e250afe6e6187c2090d0ee5c3964d686a94a02d54
        &client_secret=2c59ebaf1fbb39d6f51c885bd973ba5e749e75ee27beb958567be59af97953c3
        &redirect_uri=http%3A%2F%2Fdev.webkite.us%3A3000%2Fauth%2Fwebkite%2Fcallback"
        </pre></code>
      </section>
      <section>
        <img src="google_grants.png" />
      </section>
    </section>

    <section>
      <section>
      <h2>Implicit Grant</h2>
      <ul>
        <li>Used by Clients that cannot keep secrets</li>
        <li>Client <strong>cannot</strong> be authenticated</li>
        <li>Relies on registration of Redirect URI for security</li>
        <li>Otherwise like Authorization Code grant type</li>
        <li>Specify by sending <code>response_type=token</code><br/> to authorization endpoint</li>
      </ul>
      </section>
      <section>
        <img src="implicit-flow.png" />
        <p>Note: Redirect URI sent to authorization endpoint <strong>must</strong> match Redirect URI registered with the Authorization Server for the Client ID.</p>
      </section>
      <section>
        <h4>Example Implicit Grant Token Request</h4>
        <pre><code>curl -I http://dev.webkite.us:9000/oauth/authorize?
   client_id=8119ed6d60999c80a51f169fad28397e83b14957fb1b960bbd3500857430b83f
  &redirect_uri=http%3A%2F%2Flocalhost:1460%3A3000%2Foauth%2Fcallback
  &response_type=token

HTTP/1.1 302 Found
Status: 302 Found
Location: http://localhost:1460/oauth/callback#c046e0d13b31aa7813049a0e7156678d23172e70cbe9a36c1733fa9c14aaad42
</code></pre>
      </section>
      <section>
        <h3>Security Consideration</h3>
        <ol>
        <li>In Authorization Code Grant, how can the Resource Server be sure that the Client is not bearing an Access Token that was issued to a different Client?</li>
        <li class="fragment">What would it take to have the same assurance in the Implicit Grant Flow?</li>
        </ol>
      </section>
    </section>

    <section>
      <section>
      <h2>Authentication</h2>
      <p>OAuth 2.0 is an <em>authorization</em> protocol, but it's used for <em>authentication.</em></p>
      </section>
      <section>
        <ol>
          <li>User's account data can be the Protected Resource</li>
          <li class="fragment">Client requests token using Authorization Code or Implicit Grant</li>
          <li class="fragment">Flows require User to authenticate with Authorization Server</li>
          <li class="fragment"><strong>Requirement:</strong> Resource Server implements an endpoint for accessing account info of User who authorized a particular token <em>without identifying information other than token itself</em></li>
          <li class="fragment"><strong>Conclusion:</strong> User whose info that token authorizes access to was authenticated by Authorization Server.</li>
        </ol>
      </section>
    </section>

    <section>
      <section>
      <h3>OpenID Connect</h3>
      <a href="//openid.net/connect/">openid.net/connect/</a>
      </section>
      <section>
        <h3>Primary Difference</h3>
        <ul>
        <li class="fragment">In a typical OAuth 2.0 authentication flow, we <em>infer</em> that the Authorization Server has authenticated the user based on several assumptions.</li>
        <li class="fragment">In OpenID, we get an additional ID token that is crytopgraphically signed by the OpenID provider and is NOT opaque &mdash; it makes several assertions, including:</li>
        </ul>
        <ol>
          <li class="fragment">Who issued the token</li>
          <li class="fragment">Who the token was issued to</li>
          <li class="fragment">When the authentication event occurred</li>
          <li class="fragment">Which user of the openID provider was authenticated</li>
        </ol>
      </section>
    </section>

  </div>

</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.min.js"></script>

<script>

// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
controls: true,
progress: true,
history: true,
center: true,
//backgroundTransition: 'slide',

theme: 'simple',
transition: 'linear',

// Parallax scrolling
// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
// parallaxBackgroundSize: '2100px 900px',

// Optional libraries used to extend on reveal.js
dependencies: [
{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
]
});

</script>

</body>
</html>
